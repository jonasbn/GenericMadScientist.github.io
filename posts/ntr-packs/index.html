<!DOCTYPE html><html lang="en-GB" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Packs in Yu-Gi-Oh! Nightmare Troubadour" /><meta property="og:locale" content="en_GB" /><meta name="description" content="Yu-Gi-Oh! Nightmare Troubadour is the first Yu-Gi-Oh! game for the Nintendo DS. I don’t consider it to be especially good, and unless you’re dying for a Yu-Gi-Oh! game with the original cast, I’d suggest giving it a miss. However, it will forever hold a special place in my heart as it, along with Sonic Rush, were the two games I got with my DS one Christmas day." /><meta property="og:description" content="Yu-Gi-Oh! Nightmare Troubadour is the first Yu-Gi-Oh! game for the Nintendo DS. I don’t consider it to be especially good, and unless you’re dying for a Yu-Gi-Oh! game with the original cast, I’d suggest giving it a miss. However, it will forever hold a special place in my heart as it, along with Sonic Rush, were the two games I got with my DS one Christmas day." /><link rel="canonical" href="/posts/ntr-packs/" /><meta property="og:url" content="/posts/ntr-packs/" /><meta property="og:site_name" content="GMS Ruins Video Games" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-24T22:47:35+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Packs in Yu-Gi-Oh! Nightmare Troubadour" /><meta name="twitter:site" content="@GMS_CH" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-06-24T22:47:35+01:00","datePublished":"2021-06-24T22:47:35+01:00","description":"Yu-Gi-Oh! Nightmare Troubadour is the first Yu-Gi-Oh! game for the Nintendo DS. I don’t consider it to be especially good, and unless you’re dying for a Yu-Gi-Oh! game with the original cast, I’d suggest giving it a miss. However, it will forever hold a special place in my heart as it, along with Sonic Rush, were the two games I got with my DS one Christmas day.","headline":"Packs in Yu-Gi-Oh! Nightmare Troubadour","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/ntr-packs/"},"url":"/posts/ntr-packs/"}</script><title>Packs in Yu-Gi-Oh! Nightmare Troubadour | GMS Ruins Video Games</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="GMS Ruins Video Games"><meta name="application-name" content="GMS Ruins Video Games"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">GMS Ruins Video Games</a></div><div class="site-subtitle font-italic">Wherein I spend too much time with games</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/GenericMadScientist" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/GMS_CH" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['rayw1710','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Packs in Yu-Gi-Oh! Nightmare Troubadour</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Packs in Yu-Gi-Oh! Nightmare Troubadour</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1624571255" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 24, 2021 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/GenericMadScientist">GenericMadScientist</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1424 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://yugipedia.com/wiki/Yu-Gi-Oh!_Nightmare_Troubadour">Yu-Gi-Oh! Nightmare Troubadour</a> is the first Yu-Gi-Oh! game for the Nintendo DS. I don’t consider it to be especially good, and unless you’re dying for a Yu-Gi-Oh! game with the original cast, I’d suggest giving it a miss. However, it will forever hold a special place in my heart as it, along with Sonic Rush, were the two games I got with my DS one Christmas day.</p><p>I had occasion to replay it recently for <a href="https://retroachievements.org">RetroAchievements</a>. And it annoyed me that there’s still a lot of things not well understood about the game. So naturally, now that my playthrough is complete, it’s the perfect time to solve some of those mysteries. After that knowledge could have helped me.</p><p>This will be the first of a few planned posts wherein I dig into some of those mysteries. My first post will be on how packs work.</p><p>My research will be done with the PAL version of the game, because that’s the version I played for RetroAchievements so I already have a complete save.</p><h2 id="overview"><span class="mr-2">Overview</span><a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Yu-Gi-Oh! Nightmare Troubadour is based off the Yu-Gi-Oh! card game. You accrue cards by purchasing packs from the shop (there are a few other means, but they aren’t relevant for our purposes). Each pack contains five cards. The first four will always be common cards. The last will be a common, a rare, a super rare, or an ultra rare.</p><p><img data-src="/assets/img/ntr-three-rarities.png" alt="Rare, Super Rare, and Ultra Rare" data-proofer-ignore> <em>The three genders</em></p><p>Every in-game day the player can purchase up to 10 packs of each type of booster. Every box of 10 contains one pack with an ultra rare, two packs with a super rare, three packs with a rare, and four packs with all commons. A long-known interesting fact about the distribution of rares is that you can save the game after buying a single pack, and the distribution of the packs with rares are fixed until the next in-game day.</p><p><img data-src="/assets/img/ntr-10-packs.png" alt="Ten packs" data-proofer-ignore> <em>A new day, a new 10 packs</em></p><h2 id="the-rng-and-distribution-of-rares"><span class="mr-2">The RNG, and distribution of rares</span><a href="#the-rng-and-distribution-of-rares" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>So hey, the issue with the rares sounds interesting. Let’s see how the game determines them. To generate random numbers for pack pulls, the game uses a <a href="https://en.wikipedia.org/wiki/Linear_congruential_generator">linear congruential generator</a>, or LCG for short. The game keeps a 32-bit number called a seed. Every time the game requires a new random number, the game first changes the seed according to a mathematical transformation, then extracts the desired number from the seed. In Python, it would look like this:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Prng</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">__seed</span> <span class="o">=</span> <span class="n">seed</span>

    <span class="k">def</span> <span class="nf">rand</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">__seed</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0x343FD</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">__seed</span> <span class="o">+</span> <span class="mh">0x269EC3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">__seed</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7FFF</span>
</pre></table></code></div></div><p>To use an LCG, you must first supply an initial seed value. If we can learn (or better still, control) said initial seed value, and control when the game requests a random number, we will be able to predict all output of the random number generator, thereby controlling what cards we get from packs. Therefore, the next important issue is how the game chooses the initial seed value and when the game requests a random number.</p><p>The game takes the number of frames that have elapsed since power-on, as a 16-bit number, and uses that as the initial seed value. This happens when the player enters the menu where they select the booster they wish to buy packs of.</p><p><img data-src="/assets/img/ntr-rng-initialisation.png" alt="Going to buy packs" data-proofer-ignore> <em>The RNG is initialised in the black screen right after this</em></p><p>The first time in an in-game day the player enters this menu, right after initialising the LCG the game will use it to determine which packs contain rares, super rares, and ultra rares. The only other time the game will request random numbers is when opening a pack. The procedure the game uses to allocate the distribution of rares is as follows:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">generate_rare_slots</span><span class="p">(</span><span class="n">rng</span><span class="p">):</span>
    <span class="c1"># 4 for Ultra Rare, 3 for Super Rare, 1 for Rare, 0 for Common
</span>    <span class="n">rares</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">rare_slots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># The game has 20 types of booster
</span>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">pack_rare_slots</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
        <span class="k">for</span> <span class="n">rare</span> <span class="ow">in</span> <span class="n">rares</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">slot</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">10</span>
                <span class="k">if</span> <span class="n">pack_rare_slots</span><span class="p">[</span><span class="n">slot</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">pack_rare_slots</span><span class="p">[</span><span class="n">slot</span><span class="p">]</span> <span class="o">=</span> <span class="n">rare</span>
                    <span class="k">break</span>
        <span class="n">rare_slots</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pack_rare_slots</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rare_slots</span>
</pre></table></code></div></div><p>This is as close to a best-case scenario for manipulating the packs as we could reasonably hope for. If we do one frame-perfect input, we have perfect knowledge of the RNG’s output. Additionally, if you don’t even want to do that, there are only 65536 starting seeds so after buying one pack we will almost definitely be able to work out what the initial seed was, and what it will be going forward. That means we just need to know how the game uses the RNG to generate the contents of pack, but unfortunately that is somewhat more complicated.</p><h2 id="pack-contents"><span class="mr-2">Pack contents</span><a href="#pack-contents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The main complication comes from the fact that the developers decided to add a feature where the player does not spend an eternity getting the last rares they need. Say a pack has three potential ultra rare cards it can give you, and you already own one of them. If a pack is determined to contain an ultra rare, under normal circumstances you will have a one in three chance of getting any of them. However, if the player has opened two or more packs from that booster containing an ultra rare, and both of them gave ultra rares that the player owned before opening said packs, then the game will ensure the player gets an ultra rare they have not already obtained. In our hypothetical scenario, this would mean the player has a one in two chance of getting either unowned ultra rare, and no chance of getting the one they already own. This works in the same way for rares and super rares.</p><p>With that explanation out of the way, here is how it works:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">generate_pulls</span><span class="p">(</span><span class="n">pack_data</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">rarity</span><span class="p">,</span> <span class="n">guarantee_new</span><span class="p">,</span> <span class="n">unowned_rares</span><span class="p">):</span>
    <span class="s">"""Calculate the pulls from a pack.

    pack_data: an array of pairs of the form (card, rarity) for the pack's cards
    rng: the RNG
    rarity: 0 for common, 1 for rare, 3 for super rare, 4 for ultra rare
    guarantee_new: if the game tries to guarantee a new rare due to 2+ old ones
    unowned_rares: the rares from pack_data that are unowned
    """</span>
    <span class="k">if</span> <span class="n">rarity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">common_count</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">common_count</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">pulls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">pulls</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">common_count</span><span class="p">:</span>
        <span class="n">slot</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">pack_data</span><span class="p">)</span>
        <span class="n">new_card</span><span class="p">,</span> <span class="n">nc_rarity</span> <span class="o">=</span> <span class="n">pack_data</span><span class="p">[</span><span class="n">slot</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">new_card</span> <span class="ow">in</span> <span class="n">pulls</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">nc_rarity</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">pulls</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_card</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rarity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pulls</span>
    <span class="n">rare_pool</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">unowned_rares</span> <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="n">rarity</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">rare_pool</span> <span class="ow">and</span> <span class="n">guarantee_new</span><span class="p">:</span>
        <span class="n">slot</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">rare_pool</span><span class="p">)</span>
        <span class="n">pulls</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">rare_pool</span><span class="p">[</span><span class="n">slot</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">pulls</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">slot</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">pack_data</span><span class="p">)</span>
        <span class="n">new_card</span><span class="p">,</span> <span class="n">nc_rarity</span> <span class="o">=</span> <span class="n">pack_data</span><span class="p">[</span><span class="n">slot</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nc_rarity</span> <span class="o">==</span> <span class="n">rarity</span><span class="p">:</span>
            <span class="n">pulls</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_card</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pulls</span>
</pre></table></code></div></div><p>I have placed the contents of the packs into an XML <a href="/assets/data/ntr-packs.xml">here</a>. Order is important, so listings from GameFAQs and the like are of no use here.</p><p>To generate a card from an array, the game requests a random number from the LCG and then does modulo the length of the array, and takes the corresponding item. With this procedure, the game will generate a card and keep doing so until it gets a common. This common is then placed as the first card. The game will use this process to get another common, adding it if the game has not already decided to give the player that card. This is repeated until all the commons are done. If the pack is five commons, the generation is over.</p><p>If not, the procedure for the rare card depends on whether the new rare guarantee if active. If it is active, the game will generate the array of cards in the pack that are unowned and of the right rarity, in the same order the pack’s contents are in. If this array is non-empty, the game will pick a random element from this array for the rare. If this array is empty, the game will fall back on the procedure used when the new rare is not guarantee. Said procedure is to keep generating random cards from the full array, like with commons, until one of the right rarity is found.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/yu-gi-oh-nightmare-troubadour/'>Yu-Gi-Oh! Nightmare Troubadour</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Packs+in+Yu-Gi-Oh%21+Nightmare+Troubadour+-+GMS+Ruins+Video+Games&url=%2Fposts%2Fntr-packs%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Packs+in+Yu-Gi-Oh%21+Nightmare+Troubadour+-+GMS+Ruins+Video+Games&u=%2Fposts%2Fntr-packs%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Packs+in+Yu-Gi-Oh%21+Nightmare+Troubadour+-+GMS+Ruins+Video+Games&url=%2Fposts%2Fntr-packs%2F" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ntr-npc-spawns/"><div class="card-body"> <em class="small" data-ts="1625859579" data-df="ll" > Jul 9, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NPC spawns in Yu-Gi-Oh! Nightmare Troubadour</h3><div class="text-muted small"><p> In the previous post we looked at the details of how packs work in Yu-Gi-Oh! Nightmare Troubadour. In this post we’re going to look at how the game decides which NPCs to spawn, and a little about h...</p></div></div></a></div><div class="card"> <a href="/posts/ntr-friendship/"><div class="card-body"> <em class="small" data-ts="1626715922" data-df="ll" > Jul 19, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Friends in Yu-Gi-Oh! Nightmare Troubadour</h3><div class="text-muted small"><p> This is the third and final post I plan to do on Yu-Gi-Oh! Nightmare Troubadour. I may come back to it at a later date, but for now I’ve worked out everything I really wanted to know. Like the prev...</p></div></div></a></div><div class="card"> <a href="/posts/how-chopt-works/"><div class="card-body"> <em class="small" data-ts="1654539960" data-df="ll" > Jun 6, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How CHOpt works</h3><div class="text-muted small"><p> When I made this blog I envisioned myself talking about how other people’s programs work. However, I’ve had plenty of people ask me how my own program CHOpt works, so today I’m going to talk about ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/first-post/" class="btn btn-outline-primary" prompt="Older"><p>Hello World!</p></a> <a href="/posts/ntr-npc-spawns/" class="btn btn-outline-primary" prompt="Newer"><p>NPC spawns in Yu-Gi-Oh! Nightmare Troubadour</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/GenericMadScientist">GenericMadScientist</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script data-goatcounter="https://gmsblog.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
